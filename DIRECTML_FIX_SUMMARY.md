# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ DirectML –≤ PyTorch

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –æ–±—É—á–µ–Ω–∏—è —Å AMD GPU –Ω–∞ Windows –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
Expected one of cpu, cuda, ipu, xpu, mkldnn, opengl, opencl, ideep, hip, ve, fpga, maia, xla, lazy, vulkan, mps, meta, hpu, mtia, privateuseone device type at start of device string: directml
```

## üîç –ü—Ä–∏—á–∏–Ω–∞
PyTorch –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç —Å—Ç—Ä–æ–∫—É `"directml"` –∫–∞–∫ –≤–∞–ª–∏–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. DirectML —Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ `torch_directml.device()`.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **–û–±–Ω–æ–≤–ª–µ–Ω `gpu_utils.py`**
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è** `get_device_object()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–ò–∑–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è** `setup_device()` - —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"cpu"` –¥–ª—è DirectML, –Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç DirectML
- **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**:
  ```python
  # –î–ª—è DirectML
  if device == "directml":
      return "cpu"  # PyTorch –≤–∏–¥–∏—Ç "cpu"
      # –ù–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è torch_directml.device()
  ```

### 2. **–û–±–Ω–æ–≤–ª–µ–Ω `trainer.py`**
- **–î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç** `get_device_object`
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ** `self.device_obj` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ** `.to(device)` –Ω–∞ `.to(self.device_obj)`
- **–ò–∑–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è** `create_trainer()` –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### 3. **–û–±–Ω–æ–≤–ª–µ–Ω `main.py`**
- **–î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç** `get_device_object`
- **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è** `device_obj` –≤–æ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- **–û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—ã–∑–æ–≤—ã** `load_pretrained_model()` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### 4. **–û–±–Ω–æ–≤–ª–µ–Ω `model.py`**
- **–ò–∑–º–µ–Ω–µ–Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞** `load_pretrained_model()` –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–£–±—Ä–∞–Ω–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏—è** `device: str` - —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª—é–±–æ–π –æ–±—ä–µ–∫—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### 5. **–û–±–Ω–æ–≤–ª–µ–Ω `web_interface.py`**
- **–î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç** `get_device_object`
- **–û–±–Ω–æ–≤–ª–µ–Ω TrainingManager** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–ü–µ—Ä–µ–¥–∞—á–∞ –æ–±—ä–µ–∫—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** –≤ `create_trainer()`

## üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
device = "directml"  # ‚ùå PyTorch –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —ç—Ç—É —Å—Ç—Ä–æ–∫—É
model = model.to(device)  # ‚ùå –û—à–∏–±–∫–∞!
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
device_type = "directml"  # –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –¥–ª—è –ª–æ–≥–∏–∫–∏
device_obj = torch_directml.device()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
model = model.to(device_obj)  # ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç!
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: `detect_gpu_device()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"directml"`
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞**: `setup_device()` –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç DirectML –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"cpu"`
3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞**: `get_device_object()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `torch_directml.device()`
4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –í—Å–µ `.to()` –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:
```bash
python -c "from gpu_utils import detect_gpu_device, get_device_object; device = detect_gpu_device(); print(f'–¢–∏–ø: {device}'); print(f'–û–±—ä–µ–∫—Ç: {get_device_object(device)}')"
```

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:
```bash
python main.py train --epochs 10
```

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
```bash
python web_interface.py
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –¢–∏–ø | –û–±—ä–µ–∫—Ç | –°—Ç–∞—Ç—É—Å |
|------------|-----|--------|--------|
| NVIDIA GPU | `"cuda"` | `torch.device("cuda")` | ‚úÖ |
| AMD GPU (Windows) | `"directml"` | `torch_directml.device()` | ‚úÖ |
| AMD GPU (Linux) | `"rocm"` | `torch.device("cuda")` | ‚úÖ |
| CPU | `"cpu"` | `torch.device("cpu")` | ‚úÖ |

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –æ–±—É—á–µ–Ω–∏–µ —Å AMD GPU –Ω–∞ Windows —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ DirectML! üöÄ

### –î–ª—è –∑–∞–ø—É—Å–∫–∞:
1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ DirectML**: `pip install torch-directml`
2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ**: `python main.py train --epochs 10`
3. **–ò–ª–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: `python web_interface.py`

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç DirectML –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AMD GPU –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è!
