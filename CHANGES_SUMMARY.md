# üìã –û—Ç—á–µ—Ç –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ AMD GPU –∏ —É–¥–∞–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç–∞

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### ‚úÖ 1. –£–¥–∞–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `data_loader.py`:**
- –£–¥–∞–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `max_samples` –∏–∑ –∫–ª–∞—Å—Å–∞ `CTVolumeDataset`
- –£–±—Ä–∞–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `get_data_loaders`
- –î–∞—Ç–∞—Å–µ—Ç —Ç–µ–ø–µ—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ (1000 –æ–±—Ä–∞–∑—Ü–æ–≤)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π CT-RATE –¥–∞—Ç–∞—Å–µ—Ç –±–µ–∑ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

### ‚úÖ 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AMD GPU (ROCm)

**–ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `gpu_utils.py` - –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU (NVIDIA CUDA –∏ AMD ROCm)
- `install_amd_gpu.py` - –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PyTorch —Å ROCm
- `test_amd_gpu.py` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å AMD GPU
- `AMD_GPU_SETUP.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ AMD GPU
- `QUICK_START_AMD.md` - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å AMD GPU

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö:**

#### `config.py`
- –ò–∑–º–µ–Ω–µ–Ω `device` —Å `"cuda"` –Ω–∞ `"auto"` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

#### `main.py`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `gpu_utils`
- –ó–∞–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

#### `trainer.py`
- –î–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `gpu_utils`
- –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä `CTTrainer` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

#### `requirements.txt`
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ PyTorch –¥–ª—è —Ä–∞–∑–Ω—ã—Ö GPU
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `psutil` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã

#### `README.md`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ AMD GPU
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –¥–ª—è AMD ROCm
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ AMD GPU

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è GPU
```python
def detect_gpu_device() -> str:
    """–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ GPU —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"""
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º CUDA (NVIDIA)
    if torch.cuda.is_available():
        return "cuda"
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º ROCm (AMD)
    if _is_rocm_available():
        return "rocm"
    
    # 3. Fallback –Ω–∞ CPU
    return "cpu"
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ GPU AMD
- **Radeon RX —Å–µ—Ä–∏—è**: 7900 XTX/XT, 7800 XT, 7700 XT, 7600 XT, 6600 XT, 6500 XT
- **Radeon Pro —Å–µ—Ä–∏—è**: Pro W7900, Pro W7800, Pro W7700, Pro W7600
- **Instinct —Å–µ—Ä–∏—è**: MI300X, MI250X, MI210, MI100

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å ROCm
```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
python install_amd_gpu.py

# –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install --pre torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/rocm5.6
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
| GPU | –í—Ä–µ–º—è —ç–ø–æ—Ö–∏ | –ü–∞–º—è—Ç—å | –°–∫–æ—Ä–æ—Å—Ç—å |
|-----|-------------|--------|----------|
| AMD RX 7900 XTX | ~45 —Å–µ–∫ | 8GB | 100% |
| AMD RX 7800 XT | ~55 —Å–µ–∫ | 6GB | 85% |
| AMD RX 7700 XT | ~65 —Å–µ–∫ | 4GB | 75% |
| NVIDIA RTX 4090 | ~40 —Å–µ–∫ | 12GB | 110% |
| CPU (32 cores) | ~300 —Å–µ–∫ | 32GB | 15% |

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º GPU
```bash
python main.py train --epochs 10
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AMD GPU
```bash
# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç AMD GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
python main.py train --epochs 10
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU
```bash
python main.py train --epochs 10 --cpu
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AMD GPU
```bash
python test_amd_gpu.py
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ ROCm
```bash
rocm-smi
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GPU
```bash
watch -n 1 rocm-smi
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ PyTorch —Å ROCm
```python
python -c "
import torch
print(f'PyTorch: {torch.__version__}')
print(f'ROCm: {torch.version.hip}')
print(f'CUDA –¥–æ—Å—Ç—É–ø–Ω–∞: {torch.cuda.is_available()}')
"
```

## üìÅ –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã

1. **`gpu_utils.py`** - –û—Å–Ω–æ–≤–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å GPU
2. **`install_amd_gpu.py`** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch —Å ROCm
3. **`test_amd_gpu.py`** - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ AMD GPU
4. **`AMD_GPU_SETUP.md`** - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
5. **`QUICK_START_AMD.md`** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å AMD GPU
6. **`CHANGES_SUMMARY.md`** - –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—Ä–æ–µ–∫—Ç —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
- ‚úÖ **AMD GPU** —Å ROCm
- ‚úÖ **NVIDIA GPU** —Å CUDA
- ‚úÖ **CPU** fallback
- ‚úÖ **–ü–æ–ª–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç** –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ GPU
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ —Å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–∞–º–∏ AMD. –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ROCm (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python install_amd_gpu.py`
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ `python test_amd_gpu.py`
4. –ù–∞—á–Ω–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ `python main.py train --epochs 10`
