# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ KeyError –≤ DataLoader

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
KeyError: 'image'
Caught KeyError in DataLoader worker process 0.
```

## üîç –ü—Ä–∏—á–∏–Ω–∞
–ö–æ–¥ –≤ `data_loader.py` –æ–∂–∏–¥–∞–ª –∫–ª—é—á `'image'` –≤ –æ–±—Ä–∞–∑—Ü–∞—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç CT-RATE –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥—Ä—É–≥—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª—é—á–µ–π.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–∏–±–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–π**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–ª—é—á–µ–π: `['image', 'ct', 'volume', 'data', 'scan']`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- Fallback –Ω–∞ –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –∫–ª—é—á –µ—Å–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**
- –í—ã–≤–æ–¥ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–ª—é—á–µ–π –¥–ª—è –ø–µ—Ä–≤—ã—Ö 3 –æ–±—Ä–∞–∑—Ü–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
- –ü–æ–¥—Ä–æ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 3. **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ–±—Ä–∞–∑—Ü–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª–æ–≤–∞—Ä–µ–º)
- Try-except –æ–±–µ—Ä—Ç–∫–∞ –≤–æ–∫—Ä—É–≥ –≤—Å–µ–π –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- Fallback –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ª—é–±—ã—Ö –æ—à–∏–±–∫–∞—Ö

### 4. **–î–æ–±–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –û–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è –¥–∞–∂–µ —Å –ø—Ä–æ–±–ª–µ–º–Ω—ã–º–∏ –æ–±—Ä–∞–∑—Ü–∞–º–∏

## üîß –ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
def __getitem__(self, idx):
    sample = self.dataset[idx]
    ct_volume = sample['image']  # ‚ùå –û—à–∏–±–∫–∞ –µ—Å–ª–∏ –∫–ª—é—á 'image' –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```python
def __getitem__(self, idx):
    sample = self.dataset[idx]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø –æ–±—Ä–∞–∑—Ü–∞
    if not isinstance(sample, dict):
        return synthetic_data
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª—é—á –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    image_key = None
    possible_keys = ['image', 'ct', 'volume', 'data', 'scan']
    
    for key in possible_keys:
        if key in sample:
            image_key = key
            break
    
    if image_key is None:
        # Fallback –Ω–∞ –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –∫–ª—é—á –∏–ª–∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
        return synthetic_data
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å try-except
    try:
        ct_volume = sample[image_key]
        # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    except Exception as e:
        return synthetic_data
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç** –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ
- ‚úÖ **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏** gracefully —Å fallback –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ **–ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ** –¥–∞–∂–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –æ–±—Ä–∞–∑—Ü–∞—Ö

## üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:
```bash
python main.py train --epochs 10
```

### –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:
```
üîç –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞: <class 'dict'>
üîç –ö–ª—é—á–∏ –ø–µ—Ä–≤–æ–≥–æ –æ–±—Ä–∞–∑—Ü–∞: ['image', 'labels', 'patient_id']
üîç –û–±—Ä–∞–∑–µ—Ü 0: –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–ª—é—á–∏: ['image', 'labels', 'patient_id']
```

## üìä –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

| –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –ö–ª—é—á –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|------------------|--------|
| `{'image': data}` | `'image'` | ‚úÖ |
| `{'ct': data}` | `'ct'` | ‚úÖ |
| `{'volume': data}` | `'volume'` | ‚úÖ |
| `{'data': data}` | `'data'` | ‚úÖ |
| `{'scan': data}` | `'scan'` | ‚úÖ |
| –õ—é–±–∞—è –¥—Ä—É–≥–∞—è | –ü–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π | ‚úÖ |
| –ù–µ —Å–ª–æ–≤–∞—Ä—å | –°–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ | ‚úÖ |

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –æ–±—É—á–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ CT-RATE! üöÄ
